# <span id="page-0-0"></span>An unconditional lower bound for the active-set method in convex quadratic maximization

Eleon Bach<sup>1</sup> , Yann Disser [2](https://orcid.org/0000-0002-2085-0454) , Sophie Huiberts [3](https://orcid.org/0000-0003-2633-014X) , and Nils Mosis [2](https://orcid.org/0000-0002-0692-0647)

<sup>1</sup>EPFL, Switzerland

<sup>2</sup>TU Darmstadt, Germany

<sup>3</sup>CNRS, Univ Clermont Auvergne, INP Clermont Auvergne, Mines Saint-Etienne, LIMOS

#### Abstract

We prove that the active-set method needs an exponential number of iterations in the worstcase to maximize a convex quadratic function subject to linear constraints, regardless of the pivot rule used. This substantially improves over the best previously known lower bound [IPCO 2025], which needs objective functions of polynomial degrees ω(log d) in dimension d, to a bound using a convex polynomial of degree 2. In particular, our result firmly resolves the open question [IPCO 2025] of whether a constant degree suffices, and it represents significant progress towards linear objectives, where the active-set method coincides with the simplex method and a lower bound for all pivot rules would constitute a major breakthrough.

Our result is based on a novel extended formulation, recursively constructed using deformed products. Its key feature is that it projects onto a polygonal approximation of a parabola while preserving all of its exponentially many vertices. We define a quadratic objective that forces the active-set method to follow the parabolic boundary of this projection, without allowing any shortcuts along chords corresponding to edges of its full-dimensional preimage.

## 1 Introduction

The existence of an efficient pivot rule for the simplex method is a notorious open question since the inception of the method by Dantzig in 1947 [\[11\]](#page-11-0), and could yield a strongly polynomial algorithm for linear optimization, as well as a proof of the polynomial (monotone) Hirsch conjecture [\[10\]](#page-11-1). These are widely regarded as two of the most important open problems in the theory of linear programming [\[33,](#page-13-0) [34\]](#page-13-1).

Exponential worst-case constructions for the simplex method were found early on for many natural pivot rules [\[3,](#page-11-2) [23,](#page-12-0) [25,](#page-12-1) [29,](#page-13-2) [30\]](#page-13-3), using deformations of the hypercube, which were later unified by Amenta and Ziegler [\[1\]](#page-11-3) in terms of deformed products (see Section [3.1\)](#page-4-0). It took a breakthrough several decades later by Friedmann in 2011 [\[19\]](#page-12-2), based on a connection to parity games and Markov decision processes, in order to tackle more balanced pivot rules, such as randomized pivot rules [\[20\]](#page-12-3) and history-based pivot rules [\[4,](#page-11-4) [13\]](#page-12-4). The majority of existing results are tailored to individual rules, with exceptions including a recent lower bound by Black [\[7\]](#page-11-5) for all shadow vertex rules and some normalized-weight rules [\[8\]](#page-11-6), as well as constructions that apply to a small number of rules simultaneously [\[14,](#page-12-5) [16\]](#page-12-6). It seems highly unlikely that any of these constructions can be generalized to unconditional lower bounds for all pivot rules.

Disser and Mosis [\[15\]](#page-12-7) recently proposed a novel route to proving unconditional lower bounds by analyzing the active-set method, a natural extension of the simplex method to nonlinear objectives (see Section [2\)](#page-3-0). They proved an exponential lower bound on its running time that holds for all pivot rules — the first such result, in any setting, that is unconditional (to the best of our knowledge).

In this paper, we refine their approach by constructing an extended formulation [\[26,](#page-12-8)[38\]](#page-13-4), using the deformed-product framework of Amenta and Ziegler [\[1\]](#page-11-3), and apply it to derive an unconditional lower bound for convex quadratic maximization. Our extended formulation, when projected appropriately, approximates a portion of the parabola to high accuracy, and may be of independent interest.

Our results. We prove an unconditional exponential lower bound on the number of iterations of the active-set method for convex quadratic maximization programs that holds for all pivot rules.

<span id="page-1-1"></span>Theorem 1.1 (Theorem [3.10\)](#page-10-0). There exists a polytope P ⊆ R <sup>d</sup> with 2d facets, and a convex quadratic polynomial f : R <sup>d</sup> → R, such that, for some starting vertex, the active-set method needs 2 d iterations to maximize f over P, irrespective of the pivot rule.

This substantially improves on the lower bound by Disser and Mosis [\[15\]](#page-12-7), which requires a polynomial degree of ω(log d) for a super-polynomial bound and a polynomial degree of Ω(d) for an exponential bound, to an exponential lower bound for a convex polynomial of degree 2. In particular, we firmly resolve the open question (Question 2 in [\[15\]](#page-12-7)) of whether a constant degree can be achieved. Furthermore, our result represents significant progress towards concave quadratic (convex quadratic for minimization) objectives, where weakly polynomial algorithms exist [\[35,](#page-13-5) [39\]](#page-13-6) and the existence of a strongly polynomial algorithm is a prominent open problem. A similar result for linear functions (i.e., polynomial degree 1) would disprove the existence of a polynomial time pivot rule for the simplex method, which would constitute a major breakthrough.

The fact that our lower bound holds for a convex maximization objective is a qualitative improvement in terms of approaching a result for the simplex method, in the sense that convex functions over convex, compact domains attain their maxima at extreme points. This means that the activeset method (when started at a vertex) moves along edges of the polyhedron until reaching a local optimum at a vertex, in simplex-like fashion. For non-convex objectives, such as the one used by Disser and Mosis [\[15\]](#page-12-7), the active-set method generally moves through the interior — a behavior that differs qualitatively from the simplex method.

It is NP-complete to maximize a convex quadratic objective subject to linear constraints [\[31,](#page-13-7)[32\]](#page-13-8), implying a super-polynomial conditional lower bound on the running time of the active-set method, provided that P ̸= NP. A recent line of work approaches the complexity of the simplex method by showing that it is NP-hard to approximate the shortest monotone path between vertices of a polytope [\[9,](#page-11-7) [12\]](#page-11-8). In contrast, the value of our contribution lies in the fact that we provide an unconditional lower bound.

Our proof is based on a novel extended formulation [\[26,](#page-12-8) [38\]](#page-13-4) using deformed products [\[1\]](#page-11-3) that may be interesting in its own right. To the best of our knowledge, this represents the first extended formulation constructed via deformed products.

<span id="page-1-0"></span>Theorem 1.2 (Theorem [3.6\)](#page-8-0). For every n, d ∈ N such that d and n/(2d) are even integers, there exists a polytope P ⊆ R <sup>d</sup> with n/2 facets and (n/d) d/2 vertices and an orthogonal projection R <sup>d</sup> → R 2 such that the vertices project onto

$$
\left\{ \begin{pmatrix} x \\ x^2 - x \end{pmatrix} \in \mathbb{R}^2 \colon x \in [0,1], \ x \cdot \left( (n/d)^{d/2} - 1 \right) \in \mathbb{Z} \right\}.
$$

The key feature of our extended formulation is that its projection yields a polygonal approximation of a parabola to any accuracy. The corresponding polyhedron is combinatorially equivalent to

<span id="page-2-0"></span>![](_page_2_Figure_0.jpeg)

Figure 1: Projection of the intersection of the Ben-Tal–Nemirovski [\[6\]](#page-11-9) polyhedral approximation of the Leibniz cone {(t, x) : ∥x∥ ≤ t} with the halfspace t ≤ 1, projected to the plane t = 1 (purple). Additional vertices (orange) are not preserved, i.e., not projected onto vertices.

a cube and every vertex projects to a unique vertex of the two-dimensional polygon. In particular, it has exponentially many vertices which are preserved under the projection, i.e., no vertex projects into the interior of the shadow and no two vertices get projected to the same vertex. This property turns out to be crucial for our proof and does not hold for previous extended formulations, such as the one of Ben-Tal and Nemirovski [\[6\]](#page-11-9) yielding a regular n-gon (see Figure [1\)](#page-2-0).

Related work on extended formulations. Extended formulations were first introduced in the seminal work of Yannakakis [\[38\]](#page-13-4). One of their most popular practical applications is the approximation of the second-order cone using extended formulations of regular polygons. The first such construction was given by Ben-Tal and Nemirovski [\[6\]](#page-11-9). This construction was slightly improved and generalized later [\[17,](#page-12-9)[22,](#page-12-10)[28,](#page-13-9)[36\]](#page-13-10). In particular, Fiorini et al. [\[17\]](#page-12-9) introduced a general framework for constructing extended formulations based on symmetries called reflection relations.

The open-source solver SCIP [\[21\]](#page-12-11) included the extended formulations by Ben-Tal and Nemirovski [\[6\]](#page-11-9) and by Glineur [\[22\]](#page-12-10) up to version 7. This allowed the construction of linear approximations that allow LP algorithms, such as the simplex method, to handle second-order conic constraints. Although they are no longer included in the solver as of version 8, a number of works reported strong computational results using these constructions compared to the alternative approach of gradient-based separation, particularly when applied to robust or portfolio optimization problems [\[5,](#page-11-10) [37\]](#page-13-11), which suggests a practical relevance of these constructions.

Variations of the construction by Ben-Tal and Nemirovski have also been used to linearly approximate the quadratic costs of the unit commitment problem in electrical power production. In this context, Angulo Cárdenas et al. [\[2\]](#page-11-11) introduced an extended formulation approximating a quadratic curve using an approach comparable to the reflection relations of [\[17\]](#page-12-9). Another variation on the construction of Ben-Tal and Nemirovski was used by Huiberts et al. [\[24\]](#page-12-12) to prove a lower bound on the smoothed complexity of the simplex method using the shadow vertex pivot rule.

## <span id="page-3-0"></span>2 Simplex and active-set method

The active-set method is a well-known and natural generalization of the simplex method to nonlinear objectives (see Exercise 8.17 in [\[18\]](#page-12-13), [\[15\]](#page-12-7)). We briefly outline both algorithms.

The simplex method solves linear programs of the form

$$
\begin{array}{ll}\n\max & \mathbf{c}^\top \mathbf{x} \\
\text{s.t.} & A\mathbf{x} \leq \mathbf{b},\n\end{array} \tag{LP}
$$

where c ∈ Q<sup>n</sup> , A ∈ Qm×<sup>n</sup> , and b ∈ Qm.

The simplex method can be understood combinatorially as a traversal of P = {x: Ax ≤ b} along its edges, such that the objective is monotonically increasing. The number of iterations it takes depends on the pivot rule that governs which improving edge direction is chosen in each step in case there is more than one. The question of whether or not there exists a pivot rule guaranteeing a polynomial running time of the simplex method is arguably one of the most famous open problems in (linear) optimization. We refer to [\[10\]](#page-11-1) for more details on the simplex method.

The active-set method can be applied to nonlinear programs of the form

$$
\begin{array}{ll}\n\text{max} & f(x) \\
\text{s.t.} & Ax \leq b,\n\end{array}\n\tag{NLP}
$$

where f : R <sup>n</sup> → R is continously differentiable, A ∈ Qm×<sup>n</sup> , and b ∈ Qm. As before, we denote the feasible region by P. The set of indices of the constraints that are active in some x ∈ P is denoted by eq(x). For simplicity, we assume that P is bounded.

We use a formulation of the active-set method by Disser and Mosis [\[15\]](#page-12-7) (see Algorithm [1\)](#page-4-1), which they proved to be a natural generalization of the simplex method and the active set method for concave QPs to non-concave maximization programs.

The running time of the algorithm, i.e., the number of iterations, again highly depends on the pivot rule that determines the direction d and the indices i ∈ A and j ∈ eq(x) \ A in each iteration in case there is more than one choice. Disser and Mosis [\[15\]](#page-12-7) proved that ActiveSet does not admit any polynomial time pivot rule for objective functions that are polynomials of degree ω(log n), but the existence of efficient pivot rules was open for lower polynomial degrees. We improve this result to an exponential lower bound for maximizing a convex polynomial of degree 2.

## 3 An unconditional exponential bound for active-set

The starting point of our lower bound construction is the observation that it is easy to force the active-set method (or the simplex method) to visit roughly half of the vertices of a polygon in R 2 via a suitably chosen linear objective. However, this only yields a trivial linear lower bound on the number of iterations, since the polygon is encoded by a number of inequalities, corresponding to facets, which is linear in the number of vertices. This approach clearly is not viable for our purposes. Instead we resort to an extended formulation of a polygon with many vertices using a polyhedron with more dimensions but exponentially fewer constraints.

Using an extended formulation, however, poses the challenge that we introduce many additional edges between vertices that are not adjacent in the projection. In particular, the active-set method (or simplex) is no longer constrained to move along the boundary of the projected polygon, and

<span id="page-4-1"></span>

| ActiveSet(f,<br>Algorithm 1:<br>A,<br>b,<br>x)                                                |              |
|-----------------------------------------------------------------------------------------------|--------------|
| R<br>R<br>n →<br>input:<br>f<br>:<br>continuously differentiable,                             |              |
| :=<br>point<br>x<br>of polytope<br>P<br>{y<br>:<br>Ay<br>≤<br>b}                              |              |
| max{f(y):<br>∈ P}<br>output:<br>critical point<br>x<br>of<br>y                                |              |
| A ←<br>eq(x)                                                                                  | (active set) |
| ⊤d<br>D<br>:=<br>{d:<br>≤<br>∇f(x)<br>0} ̸=<br>∅<br>while<br>Aeq(x)·d<br>0,<br>><br>:         |              |
| ∈ D<br> {i<br>∈ A:<br>= 0} <br>take<br>d<br>maximizing<br>Ai·d                                |              |
| if<br>AA·d<br≯=<br>0:                                                                        |              |
| A ← A \ {i}<br>for some<br>i<br>∈ A<br>with<br>Ai·d<br><<br>0                                 |              |
| if<br>AA·d<br>=<br>0:                                                                         |              |
| ⊤d<br>µ<br>←<br>inf{µ<br>≥<br>0:<br>x<br>+<br>µd<br>∈ P/<br>or<br>∇f(x<br>+<br>µd)<br>≤<br>0} |              |
| x<br>←<br>x<br>+<br>µd                                                                        |              |
| ⊤d<br>∇f(x)<br>if<br>><br>0<br>:                                                              |              |
| A ← A ∪ {j}<br>for some<br>j<br>∈<br>eq(x)<br>\ A                                             |              |

may, depending on pivot rule, even move to vertices projecting to its interior, which makes it much harder to control adversarially. Known extended formulations, such as the one of Ben-Tal and Nemirovski [\[6\]](#page-11-9) do not preserve all vertices under projection (see Figure [1\)](#page-2-0).

We overcome this issue by carefully designing a novel extended formulation whose vertices project into some suited parabola (Section [3.1\)](#page-4-0). By convexity of the parabola, this means in particular that none of its vertices are projected to the interior of the resulting polygon.

In addition to constructing a suitable extended formulation, we need to choose an objective function that prevents improving moves along chords[1](#page-0-0) of the projected polygon, which may correspond to edges of the preimage (i.e., the extended formulation). We construct a convex quadratic maximization objective with this property in Section [3.2.](#page-9-0)

#### <span id="page-4-0"></span>3.1 An extended formulation approximating a parabola

We construct a convex polyhedron that has a two-dimensional projection closely approximating the set conv{(x, x<sup>2</sup> − x) : x ∈ [0, 1]}. In contrast to previous constructions via reflection relations introduced by Kaibel and Pashkovich [\[27\]](#page-12-14), such as the one by Huiberts, Lee and Zhang [\[24\]](#page-12-12), our construction is based on the notion of deformed products as introduced by Amenta and Ziegler [\[1\]](#page-11-3).

This operation requires polyhedra that are compatible in the following sense.

<span id="page-4-2"></span>Definition 3.1. Two polytopes P, Q are combinatorially equivalent if there is a bijection between their vertex sets given by {p (1) , . . . , p (m)} = vert(P) and {q (1) , . . . , q (m)} = vert(Q) such that the convex hull conv{p (i) : i ∈ I} is a face of P if and only if conv{q (i) : i ∈ I} is a face of Q for every I ⊆ {1, . . . , m}.

Definition 3.2. Two combinatorially equivalent polytopes are normally equivalent if the facet normals of corresponding facets coincide.

<sup>1</sup>A chord is a line segment connecting two vertices of a polygon that otherwise lies entirely in its interior.

<span id="page-5-0"></span>![](_page_5_Figure_0.jpeg)

Figure 2: Polygons VN,M and WN,M for N = 8, M = 10.

We use the following characterization of deformed products and refer to [\[1\]](#page-11-3) for a detailed introduction. Note that, for the first item, we assume that the vertices of V and W are labeled as per the bijection in Definition [3.1.](#page-4-2)

<span id="page-5-1"></span>Theorem 3.3 (Theorem 3.4 in [\[1\]](#page-11-3)). Let P ⊆ R d be a d-dimensional polytope, φ: R <sup>d</sup> → R be a linear function with φ(P) = [0, 1], and let V, W ⊆ R r be normally equivalent r-dimensional polytopes.

<span id="page-5-2"></span>(i) For P = conv{p (1) , . . . , p (m)}, V = conv{v (1) , . . . , v (n)} and W = conv{w(1) , . . . , w(n)}, the deformed product is given by

$$
(\mathcal{P},\varphi) \bowtie (\mathcal{V},\mathcal{W}) = \text{conv}\left\{ \begin{pmatrix} p^{(i)} \\ v^{(j)} + \varphi(p^{(i)})(w^{(j)} - v^{(j)}) \end{pmatrix} : i \in \{1,\ldots,m\}, j \in \{1,\ldots,n\} \right\}.
$$
\n(1)

<span id="page-5-3"></span>(ii) If P, V and W are given by

$$
\mathcal{P} = \{\boldsymbol{x} \in \mathbb{R}^d : A \boldsymbol{x} \leq \boldsymbol{\alpha}\}, \quad \mathcal{V} = \{\boldsymbol{u} \in \mathbb{R}^r : B \boldsymbol{u} \leq \boldsymbol{\beta}\}, \quad \mathcal{W} = \{\boldsymbol{u} \in \mathbb{R}^r : B \boldsymbol{u} \leq \boldsymbol{\beta'}\},
$$

the deformed product is

$$
(\mathcal{P}, \varphi) \bowtie (\mathcal{V}, \mathcal{W}) = \left\{ \begin{pmatrix} x \\ u \end{pmatrix} \in \mathbb{R}^{d+r} : Ax \leq \alpha, (\beta - \beta') \varphi(x) + Bu \leq \beta \right\}.
$$
 (2)

<span id="page-5-4"></span>(iii) The deformed product (P, φ) ▷◁ (V, W) is combinatorially equivalent to P × V and to P × W.

Our construction is based on two polygons, each with N mutually distinct vertices of the form h(x) := <sup>x</sup> x <sup>2</sup>−x for x ∈ [0, 1]. For even N ∈ N and some M ∈ N, we define the polygons (see Figure [2\)](#page-5-0)

$$
\mathcal{V}_{M,N} := \text{conv}\{\mathbf{v}_{\mathbf{j},\ell} : j \in \{0,\ldots,N/2-1\}, \ell \in \{0,1\}\},\
$$
  
$$
\mathcal{W}_{M,N} := \text{conv}\{\mathbf{w}_{\mathbf{j},\ell} : j \in \{0,\ldots,N/2-1\}, \ell \in \{0,1\}\},\
$$

with

$$
\boldsymbol{v}_{\boldsymbol{j},\boldsymbol{\ell}} \equiv \boldsymbol{v}_{\boldsymbol{j},\boldsymbol{\ell}}(M,N) \coloneqq \boldsymbol{h}\bigg(\frac{2M(j+\ell)-\ell}{MN-1}\bigg),
$$
  
$$
\boldsymbol{w}_{\boldsymbol{j},\boldsymbol{\ell}} \equiv \boldsymbol{w}_{\boldsymbol{j},\boldsymbol{\ell}}(M,N) \coloneqq \boldsymbol{h}\bigg(\frac{M(2j+1)-(1-\ell)}{MN-1}\bigg).
$$

Observe that, since all vertices of VM,N and WM,N are unique and lie on the convex curve x 7→ x <sup>2</sup> − x, the polygon conv(VM,N ∪ WM,N ) has exactly 2N vertices. Furthermore, we show that VM,N and WM,N are suited for taking deformed products.

### Lemma 3.4. The polygons VM,N and WM,N are normally equivalent for even M ≥ 2 and N ≥ 4.

Proof. Since the vertices of VM,N and WM,N lie on the convex curve x 7→ x <sup>2</sup> − x, they can be ordered along their respective boundaries by increasing first coordinates. We obtain the bijection mapping vj,ℓ to wj,ℓ, which trivially preserves the faces (i.e., vertices and edges) of the polygons.

To prove that the polygons are normally equivalent, we need to verify that the slopes of their edges coincide. The slope of an edge between vertices u and v is given by slope(u; v) := (v<sup>2</sup> − u2)/(v<sup>1</sup> − u1). For two vertices of the form h(x) and h(y) with x, y ∈ R, we obtain

slope(
$$
\mathbf{h}(x)
$$
;  $\mathbf{h}(y)$ ) =  $\frac{(y^2 - y) - (x^2 - x)}{y - x} = x + y - 1$ .

With this, we calculate, for all j ∈ {0, . . . , N/2 − 1},

slope(
$$
\mathbf{v}_{j,0}; \mathbf{v}_{j,1}
$$
) = 
$$
\frac{2Mj + 2M(j+1) - 1}{MN - 1} - 1
$$
$$
= \frac{M(2j+1) - 1 + M(2j+1)}{MN - 1} - 1
$$
$$
= \text{slope}(\mathbf{w}_{j,0}; \mathbf{w}_{j,1}).
$$

Analogously, for all j ∈ {0, . . . , N/2 − 2},

slope(
$$
\mathbf{v}_{j,1}
$$
;  $\mathbf{v}_{j+1,0}$ ) = 
$$
\frac{2M(j+1) - 1 + 2M(j+1)}{MN - 1} - 1
$$
$$
= \frac{M(2j+1) + M(2j+3) - 1}{MN - 1} - 1
$$
$$
= \text{slope}(\mathbf{w}_{j,1}; \mathbf{w}_{j+1,0}).
$$

Finally, we have

slope(
$$
\mathbf{v}_{N/2-1,1}
$$
;  $\mathbf{v}_{0,0}$ ) =  $\frac{(NM-1)+0}{MN-1} - 1$   
=  $\frac{M(N-1)+(M-1)}{MN-1} - 1$   
= slope( $\mathbf{w}_{N/2-1,1}$ ;  $\mathbf{w}_{0,0}$ ).

For our construction, we fix n, d ∈ N such that d and n/(2d) ≥ 2 are even integers. We recursively define polyhedra Q<sup>i</sup> ⊆ R i for even values of i, together with a projection (φ<sup>i</sup> , φ′ i ): R <sup>i</sup> → R 2 , as follows.

$$
\mathcal{Q}_2 := \text{conv}(\mathcal{V}_{2, \frac{n}{2d}} \cup \mathcal{W}_{2, \frac{n}{2d}}),\tag{3}
$$

$$
\varphi_2(\boldsymbol{x}) := x_1,\tag{4}
$$

$$
\varphi_2'(\boldsymbol{x}) := x_2. \tag{5}
$$

<span id="page-7-0"></span>![](_page_7_Figure_0.jpeg)

Figure 3: Projection of Q<sup>i</sup> to the plane (φi(x), φ′ i (x)) for n = 8, d = 2, i = 4.

For all i ∈ {2, 4, . . . , d − 2}, we let M<sup>i</sup> := (n/d) i/2 , N := n/d, and define

<span id="page-7-3"></span><span id="page-7-2"></span>
$$
\mathcal{Q}_{i+2} := (\mathcal{Q}_i, \varphi_i) \bowtie (\mathcal{V}_{M_i,N}, \mathcal{W}_{M_i,N}),
$$
\n(6)

$$
\varphi_{i+2}(\boldsymbol{x}) := x_{i+1},\tag{7}
$$

$$
\varphi'_{i+2}(\boldsymbol{x}) := x_{i+2} + \left(\frac{M_i - 1}{M_{i+2} - 1}\right)^2 \varphi'_i((x_1, \dots, x_i)^\top).
$$
\n(8)

We prove that Q<sup>i</sup> has an exponential number of vertices with respect to its description size (i.e., its number of facets), and that it projects to the parabola, as desired (see Figure [3\)](#page-7-0).

<span id="page-7-7"></span>Lemma 3.5. For every i ∈ {2, 4, . . . , d}, we have

- <span id="page-7-1"></span>(i) φi(Qi) = [0, 1],
- <span id="page-7-4"></span>(ii) Q<sup>i</sup> ⊆ R <sup>i</sup> has in 2d facets and (n/d) i/2 vertices,
- <span id="page-7-5"></span>(iii) φ<sup>i</sup> and φ ′ i define the projection

<span id="page-7-6"></span>
$$
\left\{(\varphi_i(\boldsymbol{x}),\varphi'_i(\boldsymbol{x})): \boldsymbol{x}\in\mathcal{Q}_i\right\}=\text{conv}\left\{\left(\frac{t}{M_i-1},\left(\frac{t}{M_i-1}\right)^2-\frac{t}{M_i-1}\right):t\in\{0,\ldots,M_i-1\}\right\}.\hspace{0.5cm} (9)
$$

This projection is orthogonal.

Proof. We prove [\(i\)](#page-7-1) via induction on i. For i = 2, we have

$$
\varphi_2(\mathrm{conv}(\mathcal{V}_{M,N}\cup \mathcal{W}_{M,N}))\supseteq \varphi_2(\mathrm{conv}\{\boldsymbol{v}_{0,0},\boldsymbol{v}_{N/2-1,1}\})=\mathrm{conv}\{\varphi_2(\boldsymbol{v}_{0,0}),\varphi_2(\boldsymbol{v}_{N/2-1,1})\}=[0,1].
$$

Now, for i + 2, by induction, the assumption of Theorem [3.3](#page-5-1) holds for the deformed product in [\(6\)](#page-7-2). Since VMi,N , WMi,N ⊆ R 2 , Theorem [3.3](#page-5-1) [\(i\)](#page-5-2) and [\(7\)](#page-7-3) yield that every value in φi+2(Qi+2) is given by the convex combination of first coordinates of all vectors of the form vj,ℓ + φi(p)(wj,ℓ − vj,ℓ) with p ∈ Q<sup>i</sup> . By induction, there is a choice of p with φi(p) = 0, which means that we only need to identify vectors of the form vj,ℓ with first coordinates 0 and 1, respectively. The vectors v0,<sup>0</sup> and vN/2−1,<sup>1</sup> are a suitable choice.

For [\(ii\),](#page-7-4) note that, by Theorem [3.3](#page-5-1) and [\(i\),](#page-7-1) VM,N , WM,N ∈ R 2 inductively implies Q<sup>i</sup> ⊆ R i . Since VM,N and WM,N are polygons with N vertices, they can each be expressed by systems of N inequalities. Theorem [3.3](#page-5-1) [\(ii\)](#page-5-3) yields that each deformed product in [\(6\)](#page-7-2) adds N inequalities and thus facets to the description of Q<sup>i</sup> , yielding iN/2 = in 2d facets overall. Last, Theorem [3.3](#page-5-1) [\(iii\)](#page-5-4) implies that each deformed product multiplies the number of vertices by N, for a total number of Ni/<sup>2</sup> vertices of Q<sup>i</sup> .

For [\(iii\),](#page-7-5) first observe that the right-hand side of [\(9\)](#page-7-6) has the same number of vertices as Q<sup>i</sup> . It thus suffices to prove the following two statements for i ∈ {2, 4, . . . , d}:

- for every t ∈ {0, 1, . . . , M<sup>i</sup> − 1} there exists a vertex q ∈ Q<sup>i</sup> such that φi(q) = <sup>t</sup> Mi−1
- for every vertex q ∈ Q<sup>i</sup> we have φ ′ i (q) = φi(q) <sup>2</sup> − φi(q).

We prove these by induction. The statements are true for i = 2 by inspection. Now, assuming they are true for i, we prove them for i + 2. Let t ∈ {0, 1, . . . , Mi+2 − 1} and denote by k ∈ N the unique number such that kM<sup>i</sup> ≤ t ≤ (k + 1)M<sup>i</sup> − 1. Observe that k ≤ N − 1 as NM<sup>i</sup> = Mi+2.

We write k = 2j + ℓ, where j ∈ N and ℓ ∈ {0, 1}, such that (2j + ℓ)M<sup>i</sup> ≤ t ≤ (2j + ℓ + 1)M<sup>i</sup> − 1. Further, we define

<span id="page-8-3"></span>
$$
s := (1 - \ell)(t - 2jM_i) + \ell((2j + 2)M_i - 1 - t) \in \mathbb{Z}
$$
\n(10)

,

and note that 0 ≤ s ≤ M<sup>i</sup> − 1. Thus, by the induction hypothesis, there exists a vertex q ∈ Q<sup>i</sup> with φi(q) = <sup>s</sup> Mi−1 . By Theorem [3.3](#page-5-1) we know that p := <sup>q</sup> vj,ℓ+φi(q)(wj,ℓ−vj,ℓ) is a vertex of Qi+2 and it satisfies

$$
\varphi_{i+2}(\boldsymbol{p}) = \varphi_2(\boldsymbol{v}_{\boldsymbol{j},\boldsymbol{\ell}}) + \varphi_i(\boldsymbol{q}) (\varphi_2(\boldsymbol{w}_{\boldsymbol{j},\boldsymbol{\ell}}) - \varphi_2(\boldsymbol{v}_{\boldsymbol{j},\boldsymbol{\ell}}))) \n= \frac{2M_i(j+\ell) - \ell}{M_{i+2} - 1} + \frac{s}{M_i - 1} \cdot \frac{(M_i - 1)(1 - 2\ell)}{M_{i+2} - 1} \n= \frac{t}{M_{i+2} - 1},
$$

which concludes the induction for the first statement.

Note that Qi+2 has Mi+2 vertices by [\(ii\).](#page-7-4) Thus, the first inductive statement yields a bijection between the integers from 0 to Mi+2 − 1 and the vertices of Qi+2. Since in the argument above t ∈ {0, 1, . . . , Mi+2 − 1} was chosen arbitrarily and p is the vertex of Qi+2 corresponding to t, for the second statement it suffices to prove

<span id="page-8-2"></span>
$$
\varphi'_{i+2}(\boldsymbol{p}) = \varphi_{i+2}(\boldsymbol{p})^2 - \varphi_{i+2}(\boldsymbol{p}). \tag{11}
$$

We defer this technical part of the proof to Appendix [A.](#page-14-0)

We are left to prove that the projection x 7→ (ϕi(x), ϕ′ i (x)) is orthogonal. For this, denote the standard orthonormal basis by e1, . . . , e<sup>i</sup> ∈ R i . Note that ϕi(x) = e ⊤ <sup>i</sup>−1x, but ei−<sup>1</sup> ∈ ker(ϕ ′ i ) since the latter only depends on the even-indexed components of x.

By setting i = d in Lemma [3.5,](#page-7-7) we can extract the main result of this section. This proves Theorem [3.6](#page-8-0) (restated Theorem [1.2\)](#page-1-0).

<span id="page-8-0"></span>Theorem 3.6. For every n, d ∈ N such that d and n/(2d) ≥ 2 are even integers, there exists a polytope P ∈ R <sup>d</sup> with n/2 facets and M := (n/d) d/2 vertices, and an orthogonal projection Π: R <sup>d</sup> → R <sup>2</sup> with

$$
\Pi(\mathcal{P}) = \text{conv}\left\{ \left( \frac{t}{M-1}, \left( \frac{t}{M-1} \right)^2 - \frac{t}{M-1} \right) : t \in \{0, 1, \dots, M-1\} \right\}.
$$

We emphasize that none of the vertices of the extended formulation project to the interior of its shadow.

<span id="page-8-1"></span>Corollary 3.7. Consider the polytope P and the projection Π of Theorem [3.6.](#page-8-0) There is a bijection between the vertices of P and the vertices of Π(P).

Proof. Every face of the shadow Π(P) is the projection of a face of the polytope P. In particular, every vertex of the shadow is the projection of a vertex of P, which defines a bijection as both polytopes have M vertices.

<span id="page-9-2"></span>![](_page_9_Figure_0.jpeg)

Figure 4: Objective function values along vertices and edges of the projection Π(P) in [\(QP\)](#page-9-1) for n = M = 16, d = 4. Purple edges are monotonically increasing in objective value, while the orange edge and chords have negative gradients at both endpoints.

#### <span id="page-9-0"></span>3.2 Active-set on the extended parabola

Using the polytope of Theorem [3.6](#page-8-0) with n = 4d, we prove that ActiveSet is exponential for the convex quadratic maximization problem

<span id="page-9-3"></span><span id="page-9-1"></span>
$$
\max \quad x_1^2 - c \cdot x_1 - x_2
$$
  
s.t.  $\mathbf{x} \in \mathcal{P},$  (QP)

where c := 1 − 3 2M−2 . Denote the vertices of the projection Π(P) by

$$
\boldsymbol{x}^{(t)} = \frac{1}{M-1} \left( t, \frac{t^2}{M-1} - t \right)^{\top} \in \mathbb{R}^2, \tag{12}
$$

for t ∈ {0, 1, . . . , M − 1}.

We show that there are no improving chords in the projection (see Figure [4\)](#page-9-2).

<span id="page-9-6"></span>Lemma 3.8. In every vertex x (t) of Π(P) with t < M −1, and for all k ∈ Z with 0 ≤ t+k ≤ M −1, the direction (x (t+k) − x (t) ) is improving with respect to the objective f(x1, x2) = x 2 <sup>1</sup> − c · x<sup>1</sup> − x<sup>2</sup> if and only if k = 1.

Proof. Let t ∈ {0, 1, . . . , M − 2} and k ∈ Z with 0 ≤ t + k ≤ M − 1. We have

$$
\boldsymbol{x}^{(t+k)} - \boldsymbol{x}^{(t)} = \frac{1}{M-1} \left( k, \frac{(t+k)^2}{M-1} - (t+k) - \frac{t^2}{M-1} + t \right)^{\top}
$$
$$
= \frac{k}{M-1} \left( 1, \frac{2t+k}{M-1} - 1 \right)^{\top} . \tag{13}
$$

Further, the gradient of the objective in x ∈ R 2 is given by

<span id="page-9-5"></span><span id="page-9-4"></span>
$$
\nabla f(\boldsymbol{x}) = \left(2x_1 + \frac{3/2}{M-1} - 1, -1\right)^{\top}.
$$
 (14)

By [\(12\)](#page-9-3), [\(13\)](#page-9-4), and [\(14\)](#page-9-5) we get

$$
\nabla f(\mathbf{x}^{(t)})^{\top} (\mathbf{x}^{(t+k)} - \mathbf{x}^{(t)}) = \frac{k}{M-1} \left( \frac{2t}{M-1} - \frac{M-\frac{5}{2}}{M-1} - \frac{2t+k}{M-1} + 1 \right)
$$
$$
= \frac{k}{(M-1)^2} \left( \frac{3}{2} - k \right).
$$

We infer that ∇f(x (t) ) <sup>⊤</sup>(x (t+k) − x (t) ) > 0 if and only if 0 < k < <sup>3</sup> <sup>2</sup> which finally implies k = 1 since k ∈ Z.

We conclude that the improving direction in each step of ActiveSet for [\(QP\)](#page-9-1) is uniquely determined. Therefore the behavior of ActiveSet does not depend on the choice of a pivot rule.

<span id="page-10-1"></span>Lemma 3.9. In every non-optimal vertex of P, there is a unique improving edge with respect to the objective in [\(QP\)](#page-9-1). These improving edges form a path H in the graph of P that visits all vertices and projects to Π(H) = x (0) , x (1) , . . . , x (M−1) .

Proof. By Corollary [3.7,](#page-8-1) there is a bijection between the vertices of P and the vertices of Π(P). Hence, there is an injective map from the set of edges of P to the set of line segments between vertices of Π(P), i.e., from the edges of P to the edges and chords of Π(P). Since the objective f(x) = x 2 <sup>1</sup> − c · x<sup>1</sup> − x<sup>2</sup> is invariant under the projection Π, i.e., we have f(x) = f(y) for all x, y ∈ R d with (y1, y2) = Π(x) <sup>⊤</sup>, Lemma [3.8](#page-9-6) yields the statement.

We conclude our main result that the active-set method takes a exponential number of iterations for our construction, irrespective of pivot rule. This proves Theorem [1.1.](#page-1-1)

<span id="page-10-0"></span>Theorem 3.10. ActiveSet, when started at the unique vertex x¯ ∈ P with Π(x¯) = x (0), takes 2 m/2 iterations, where m denotes the number of facets of P ⊆ R m/2 .

Proof. First observe that, since the objective is convex, movement along an improving edge remains improving until reaching the endpoint of the edge. That is, for any two points x and y, we have

$$
\nabla f(\boldsymbol{x})^\top (\boldsymbol{y} - \boldsymbol{x}) > 0 \implies \nabla f(\boldsymbol{x} + \lambda (\boldsymbol{y} - \boldsymbol{x}))^\top (\boldsymbol{y} - \boldsymbol{x}) > 0, \, \forall \lambda \in [0,1].
$$

Therefore, when ActiveSet moves from a vertex along an improving edge, it will keep moving until reaching the endpoint of this edge (a new vertex). Lemma [3.9](#page-10-1) immediately yields that ActiveSet visits all vertices of the feasible region of [\(QP\)](#page-9-1) when started in x¯. Also observe that the vertex y¯ ∈ P with Π(y) = x (M−1) = (1, 0)<sup>⊤</sup> is the optimum of [\(QP\)](#page-9-1).

By Theorem [3.6](#page-8-0) and since n = 4d, the polytope P ⊆ R <sup>d</sup> has m = n/2 = 2d facets and M = (n/d) d/<sup>2</sup> = 2n/<sup>4</sup> = 2m/<sup>2</sup> vertices. In particular, P ⊆ R m/2 . As observed, ActiveSet visits all these vertices.

## 4 Future research

We may also relate our result to disproving the monotone Hirsch conjecture [\[10\]](#page-11-1), by extending the definition of the monotone diameter of a polytope to convex quadratic objective functions. Lemma [3.9](#page-10-1) then yields the following.

Corollary 4.1. The largest possible monotone diameter with respect to a convex quadratic objective is exponential.

While a general bound for linear objectives, i.e., for the simplex method, would be a major breakthrough, reaching quadratic concave objectives would already be very interesting: Much like in the linear setting, only weakly polynomial algorithms are known, namely ellipsoid and interiorpoint methods [\[35,](#page-13-5)[39\]](#page-13-6), and the active-set method is a promising candidate for a strongly polynomial algorithm, due to its combinatorial nature.

Question 1. Is there a concave, quadratic polynomial over some polytope for which the active-set method takes super-polynomially many iterations for all pivot rules?

## References

- <span id="page-11-3"></span>[1] Amenta, N., Ziegler, G.M.: Deformed products and maximal shadows of polytopes. Contemporary Mathematics 223, pp. 57–90 (1999)
- <span id="page-11-11"></span>[2] Angulo Cárdenas, A.A., Mancilla-David, F., Palma-Behnke, R.E., Espinoza, D.G.: A polyhedral-based approach applied to quadratic cost curves in the unit commitment problem. IEEE Transactions on Power Systems 31(5), 3674–3683 (2016). doi[:10.1109/TPWRS.2015.2499442](https://doi.org/10.1109/TPWRS.2015.2499442)
- <span id="page-11-2"></span>[3] Avis, D., Chvátal, V.: Notes on Bland's pivoting rule. Polyhedral Combinatorics: Dedicated to the memory of D.R. Fulkerson pp. 24–34 (1978)
- <span id="page-11-4"></span>[4] Avis, D., Friedmann, O.: An exponential lower bound for Cunningham's rule. Mathematical Programming 161, pp. 271–305 (2017)
- <span id="page-11-10"></span>[5] Bärmann, A., Heidt, A., Martin, A., Pokutta, S., Thurner, C.: Polyhedral approximation of ellipsoidal uncertainty sets via extended formulations: a computational case study. Computational Management Science 13, 151–193 (2016)
- <span id="page-11-9"></span>[6] Ben-Tal, A., Nemirovski, A.: On polyhedral approximations of the second-order cone. Mathematics of Operations Research 26(2), 193–205 (2001)
- <span id="page-11-5"></span>[7] Black, A.E.: Exponential lower bounds for many pivot rules for the simplex method. In: Proceedings of the 26th Conference on Integer Programming and Combinatorial Optimization (IPCO) (2025),<https://arxiv.org/abs/2403.04886>
- <span id="page-11-6"></span>[8] Black, A.E., Loera, J.A.D., Lütjeharms, N., Sanyal, R.: The polyhedral geometry of pivot rules and monotone paths. SIAM Journal on Applied Algebra and Geometry 7(3), 623–650 (2023). doi[:10.1137/22M1475910](https://doi.org/10.1137/22M1475910)
- <span id="page-11-7"></span>[9] Cardinal, J., Steiner, R.: Inapproximability of shortest paths on perfect matching polytopes. Mathematical Programming 210(1), 147–163 (2025). doi[:10.1007/s10107-023-02025-4](https://doi.org/10.1007/s10107-023-02025-4)
- <span id="page-11-1"></span>[10] Dantzig, G.: Linear programming and extensions. Princeton university press (1963)
- <span id="page-11-0"></span>[11] Dantzig, G.B.: Reminiscences about the origins of linear programming. Operations Research Letters 1(2), 43–48 (1982). doi[:10.1016/0167-6377\(82\)90043-8](https://doi.org/10.1016/0167-6377(82)90043-8)
- <span id="page-11-8"></span>[12] De Loera, J.A., Kafer, S., Sanità, L.: Pivot rules for circuit-augmentation algorithms in linear optimization. SIAM Journal on Optimization 32(3), 2156–2179 (2022). doi[:10.1137/21M1402457](https://doi.org/10.1137/21M1402457)

- <span id="page-12-4"></span>[13] Disser, Y., Friedmann, O., Hopp, A.V.: An exponential lower bound for Zadeh's pivot rule. Mathematical Programming 199(1-2), 865–936 (2023)
- <span id="page-12-5"></span>[14] Disser, Y., Mosis, N.: A unified worst case for classical simplex and policy iteration pivot rules. In: Proceedings of the 34th International Symposium on Algorithms and Computation (ISAAC). pp. 27:1–27:17 (2023)
- <span id="page-12-7"></span>[15] Disser, Y., Mosis, N.: An unconditional lower bound for the active-set method on the hypercube. In: Proceedings of the 23rd Conference on Integer Programming and Combinatorial Optimization (IPCO). pp. 213–227 (2025)
- <span id="page-12-6"></span>[16] Disser, Y., Skutella, M.: The simplex algorithm is NP-mighty. ACM Transactions on Algorithms 15(1), 1–19 (2018)
- <span id="page-12-9"></span>[17] Fiorini, S., Rothvoß, T., Tiwary, H.R.: Extended formulations for polygons. Discrete & computational geometry 48(3), 658–668 (2012)
- <span id="page-12-13"></span>[18] Fletcher, R.: Practical Methods of Optimization. John Wiley & Sons (2000)
- <span id="page-12-2"></span>[19] Friedmann, O.: A subexponential lower bound for Zadeh's pivoting rule for solving linear programs and games. In: Proceedings of the 15th Conference on Integer Programming and Combinatorial Optimization (IPCO). pp. 192–206 (2011)
- <span id="page-12-3"></span>[20] Friedmann, O., Hansen, T.D., Zwick, U.: Subexponential lower bounds for randomized pivoting rules for the simplex algorithm. In: Proceedings of the 43rd ACM Symposium on Theory of Computing (STOC). pp. 283–292 (2011)
- <span id="page-12-11"></span>[21] Gamrath, G., Anderson, D., Bestuzheva, K., Chen, W.K., Eifler, L., Gasse, M., Gemander, P., Gleixner, A., Gottwald, L., Halbig, K., Hendel, G., Hojny, C., Koch, T., Le Bodic, P., Maher, S.J., Matter, F., Miltenberger, M., Mühmer, E., Müller, B., Pfetsch, M.E., Schlösser, F., Serrano, F., Shinano, Y., Tawfik, C., Vigerske, S., Wegscheider, F., Weninger, D., Witzig, J.: The SCIP Optimization Suite 7.0. Technical report, Optimization Online (Mar 2020), [http://www.optimization-online.org/DB\\_HTML/2020/03/7705.html](http://www.optimization-online.org/DB_HTML/2020/03/7705.html)
- <span id="page-12-10"></span>[22] Glineur, F.: Polyhedral approximation of the second-order cone: computational experiments. Tech. rep., Faculté Polytechnique de Mons (2000), [https://web.archive.org/web/](https://web.archive.org/web/20220505114903/https://perso.uclouvain.be/francois.glineur/oldwww/Papers/Image0001.ps.gz) [20220505114903/https://perso.uclouvain.be/francois.glineur/oldwww/Papers/Image0001.ps.](https://web.archive.org/web/20220505114903/https://perso.uclouvain.be/francois.glineur/oldwww/Papers/Image0001.ps.gz) [gz](https://web.archive.org/web/20220505114903/https://perso.uclouvain.be/francois.glineur/oldwww/Papers/Image0001.ps.gz)
- <span id="page-12-0"></span>[23] Goldfarb, D., Sit, W.Y.: Worst case behavior of the steepest edge simplex method. Discrete Applied Mathematics 1(4), 277–285 (1979)
- <span id="page-12-12"></span>[24] Huiberts, S., Lee, Y.T., Zhang, X.: Upper and lower bounds on the smoothed complexity of the simplex method. In: Proceedings of the 55th ACM Symposium on Theory of Computing (STOC). pp. 1904–1917 (2023)
- <span id="page-12-1"></span>[25] Jeroslow, R.G.: The simplex algorithm with the pivot rule of maximizing criterion improvement. Discrete Mathematics 4(4), 367–377 (1973)
- <span id="page-12-8"></span>[26] Kaibel, V.: Extended formulations in combinatorial optimization. Optima 85, 2–7 (2011)
- <span id="page-12-14"></span>[27] Kaibel, V., Pashkovich, K.: Constructing extended formulations from reflection relations. In: Proceedings of the 15th Conference on Integer Programming and Combinatorial Optimization (IPCO). pp. 287–300 (2011)

- <span id="page-13-9"></span>[28] Kaibel, V., Pashkovich, K.: Constructing extended formulations from reflection relations. Facets of Combinatorial Optimization: Festschrift for Martin Grötschel pp. 77–100 (2013)
- <span id="page-13-2"></span>[29] Klee, V., Minty, G.J.: How good is the simplex algorithm? Inequalities 3(3), pp. 159–175 (1972)
- <span id="page-13-3"></span>[30] Murty, K.G.: Computational complexity of parametric linear programming. Mathematical Programming 19(1), pp. 213–219 (1980)
- <span id="page-13-7"></span>[31] Pardalos, P.M., Vavasis, S.A.: Quadratic programming with one negative eigenvalue is NPhard. Journal of Global Optimization 1(1), 15–22 (1991)
- <span id="page-13-8"></span>[32] Sahni, S.: Computationally related problems. SIAM Journal on Computing 3(4), 262–279 (1974)
- <span id="page-13-0"></span>[33] Santos, F.: A counterexample to the Hirsch conjecture. Annals of Mathematics pp. 383–412 (2012)
- <span id="page-13-1"></span>[34] Smale, S.: Mathematical problems for the next century. Mathematics: frontiers and perspectives pp. 271–294 (2000)
- <span id="page-13-5"></span>[35] Tarasov, S.P., Khachiyan, L.G.: Polynomial solvability of convex quadratic programming. Doklady Akademii Nauk 248(5), 1049–1051 (1979)
- <span id="page-13-10"></span>[36] Vandaele, A., Gillis, N., Glineur, F.: On the linear extension complexity of regular n-gons. Linear Algebra and its Applications 521, 217–239 (2017). doi[:10.1016/j.laa.2016.12.023](https://doi.org/10.1016/j.laa.2016.12.023)
- <span id="page-13-11"></span>[37] Vielma, J.P., Ahmed, S., Nemhauser, G.L.: A lifted linear programming branch-and-bound algorithm for mixed-integer conic quadratic programs. INFORMS Journal on Computing 20(3), 438–450 (Aug 2008). doi[:10.1287/ijoc.1070.0256,](https://doi.org/10.1287/ijoc.1070.0256)<http://dx.doi.org/10.1287/ijoc.1070.0256>
- <span id="page-13-4"></span>[38] Yannakakis, M.: Expressing combinatorial optimization problems by linear programs. Journal of Computer and System Sciences 43(3), 441–466 (1991). doi[:10.1016/0022-0000\(91\)90024-Y](https://doi.org/10.1016/0022-0000(91)90024-Y)
- <span id="page-13-6"></span>[39] Ye, Y., Tse, E.: An extension of Karmarkar's projective algorithm for convex quadratic programming. Mathematical Programming 44, 157–179 (1989)

## <span id="page-14-0"></span>A Final step of Lemma [3.5](#page-7-7)

It remains to prove [\(11\)](#page-8-2). We first carry out some preparatory computations, which we then combine to obtain the desired identity. In the following, note that ℓ ∈ {0, 1} implies ℓ = ℓ 2 .

First, we have

$$
\varphi_2'(\mathbf{v}_{\mathbf{j},\ell})
$$
\n
$$
= (\varphi_2(\mathbf{v}_{\mathbf{j},\ell}))^2 - \varphi_2(\mathbf{v}_{\mathbf{j},\ell})
$$
\n
$$
= \left(\frac{2M_i(j+\ell) - \ell}{M_{i+2} - 1}\right)^2 - \frac{(2M_i(j+\ell) - \ell)(M_{i+2} - 1)}{(M_{i+2} - 1)^2}
$$
\n
$$
= \frac{4j^2M_i^2 + 8j\ell M_i^2 - 4\ell jM_i + 4\ell M_i^2 - 4\ell M_i - 2jM_iM_{i+2} - 2\ell M_iM_{i+2} + \ell M_{i+2} + 2jM_i + 2\ell M_i}{(M_{i+2} - 1)^2}.
$$
\n(15)

Second, due to

$$
\varphi_2'(\mathbf{w}_{\mathbf{j},\ell}) - \varphi_2'(\mathbf{v}_{\mathbf{j},\ell}) = (\varphi_2(\mathbf{w}_{\mathbf{j},\ell}))^2 - \varphi_2(\mathbf{w}_{\mathbf{j},\ell}) - (\varphi_2(\mathbf{v}_{\mathbf{j},\ell}))^2 + \varphi_2(\mathbf{v}_{\mathbf{j},\ell}) \n= (\varphi_2(\mathbf{w}_{\mathbf{j},\ell}) - \varphi_2(\mathbf{v}_{\mathbf{j},\ell}))((\varphi_2(\mathbf{w}_{\mathbf{j},\ell}) + \varphi_2(\mathbf{v}_{\mathbf{j},\ell}) - 1) \n= \frac{(M_i - 1)(1 - 2\ell)}{M_{i+2} - 1} \left( \frac{4jM_i + 2\ell M_i + M_i - 1 - (M_{i+2} - 1)}{M_{i+2} - 1} \right)
$$

and φi(q) = <sup>s</sup> <sup>M</sup>i−<sup>1</sup> we have

$$
\varphi_i(\mathbf{q})(\varphi_2'(\mathbf{w}_{\mathbf{j},\ell}) - \varphi_2'(\mathbf{v}_{\mathbf{j},\ell}))
$$
\n
$$
= \frac{s(1-2\ell)}{M_{i+2}-1} \left( \frac{4jM_i + 2\ell M_i + M_i - 1 - (M_{i+2}-1)}{M_{i+2}-1} \right)
$$
\n
$$
= \frac{4jsM_i + 2\ell sM_i + sM_i - sM_{i+2} - 8s\ell jM_i - 4s\ell M_i - 2s\ell M_i + 2s\ell M_{i+2}}{(M_{i+2}-1)^2}.
$$
\n(16)

Third, by induction,

$$
\varphi_i'(\boldsymbol{q}) = \varphi_i(\boldsymbol{q})^2 - \varphi_i(\boldsymbol{q}) = \left(\frac{s}{M_i-1}\right)^2 - \frac{s}{M_i-1}
$$

and we thus have

$$
\left(\frac{M_i - 1}{M_{i+2} - 1}\right)^2 \varphi'_i(\mathbf{q}) = \frac{s^2 - sM_i + s}{(M_{i+2} - 1)^2}.
$$
\n(17)

<span id="page-14-2"></span><span id="page-14-1"></span>,

Fourth, [\(10\)](#page-8-3) yields, for both values of ℓ ∈ {0, 1},

$$
t = (2\ell - 1)(4j\ell M_i - 2jM_i + 2\ell M_i - \ell - s).
$$

With (2ℓ − 1)<sup>2</sup> = 1, since ℓ ∈ {0, 1}, we get

$$
t^2 = 8j\ell M_i^2 - 4j\ell M_i - 8j\ell s M_i + 4j^2 M_i^2 + 4js M_i + 4M_i^2 \ell - 4\ell M_i - 4\ell s M_i + \ell + 2\ell s + s^2. \tag{18}
$$

Fifth, we have

$$
- t(M_{i+2} - 1)
$$
  
= - 2\ell M\_i M\_{i+2} + \ell M\_{i+2} + 2\ell s M\_{i+2} - 2j M\_i M\_{i+2} - s M\_{i+2} + 2\ell M\_i - \ell - 2\ell s + 2j M\_i + s. (19)

By combining [\(15\)](#page-14-1)-[\(19\)](#page-14-2), we finally obtain

$$
\varphi'_{i+2}(\boldsymbol{p}) = \varphi'_{2}(\boldsymbol{v}_{j,\ell}) + \varphi_{i}(q)(\varphi'_{2}(\boldsymbol{w}_{j,\ell}) - \varphi'_{2}(\boldsymbol{v}_{j,\ell})) + \left(\frac{M_{i}-1}{M_{i+2}-1}\right)^{2} \varphi'_{i}(q)
$$
  
= 
$$
\frac{t^{2} - t(M_{i+2}-1)}{(M_{i+2}-1)^{2}}
$$
  
= 
$$
\varphi_{i+2}(\boldsymbol{p})^{2} - \varphi_{i+2}(\boldsymbol{p}).
$$